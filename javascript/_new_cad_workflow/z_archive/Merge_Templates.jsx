//Merge Template Rebuild//Author: William Dowling//Date: 9/17/15function mergeDocuments(){    function getTargetDoc(){        if(app.documents.length>1){            var targetIndex = new Window("dialog", "Which is Master");                var newTextGroup = targetIndex.add("group");                    newTextGroup.text = targetIndex.add("statictext",undefined,"Which file do you want to merge to?");                    newTextGroup.align = "center";                var radioGroup = targetIndex.add("group");                    radioGroup.alignChildren = "left";                    radioGroup.orientation = "column";                    for(var a=0;a<app.documents.length;a++){                        if(app.documents[a] != app.activeDocument){                            radioGroup.add("radiobutton",undefined,app.documents[a].name);                        }                    }                    radioGroup.children[0].value = true;                var buttonGroup = targetIndex.add("group");                    var ok = buttonGroup.add("button", undefined, "OK");                    var can = buttonGroup.add("button", undefined, "Cancel");            function selected(which){                for(var c=0;c<which.children.length;c++){                    if(which.children[c].value == true){                        return which.children[c].text;                    }                }            }            if(targetIndex.show() == 1){                return (selected(radioGroup));            }            else{                return;            }            targetIndex.show();        }        else{            alert("You need to have more than 1 document open!");            valid = false;            return;        }    }        function createNewArtboard(){        master.activate();        var aBcount = master.artboards.length;        var lastAB = master.artboards[master.artboards.length-1];        var aB = lastAB.artboardRect;        var left = aB[0];        var top = aB[1];        var right = aB[2];        var bot = aB[3];        var moveRight = 2100;        var moveDown = 2600;        if(aBcount != 4 && aBcount != 8){            var newLeft = left + moveRight;            var newRight = right + moveRight;            var rect = [newLeft,top,newRight,bot];            var newAb = master.artboards.add(rect);        }        else{            var originAb = master.artboards[0].artboardRect;            var oLeft = originAb[0];            var oTop = originAb[1];            var oRight = originAb[2];            var oBot = originAb[3];            if(aBcount >=4 && aBcount<8){				oTop = oTop - moveDown;				oBot = oBot - moveDown;			}			else if(aBcount>=8 &&aBcount<=12){				oTop = oTop - (moveDown*2);				oBot = oBot - (moveDown*2);			}            var rect = [oLeft,oTop,oRight,oBot];            var newAb = master.artboards.add(rect);        }                //determine how far in which direction the duplicates should move        if(aBcount < 4){            move = [(aBcount)*2100, 0]        }        else if(aBcount == 4){            move = [0,3000];        }        else if(aBcount>4 && aBcount<8){            move = [(aBcount)*2100, 3000];        }        else if(aBcount == 8){            move = [0,6000];        }        else if(aBcount > 8 && aBcount<12){            move = [(aBcount)*2100, 6000];        }        else{            alert("Sorry. No more than 12 mockups are allowed in the same file.");            valid = false;            return;        }    }        function copyArt(){        docRef.activate();        app.executeMenuCommand('selectall');//         translateArt(docRef.selection,move[0],move[1]);        app.executeMenuCommand('copy');    }        function pasteArt(){        master.activate();        if(app.pasteRemembersLayers == false){            app.pasteRemembersLayers = true;            app.executeMenuCommand('pasteInPlace');            app.pasteRemembersLayers = false;        }        else{            app.executeMenuCommand('pasteInPlace');        }        app.selection = null;    }        function translateArt(sel,right,down){        for(var a=0;a<sel.length;a++){            var cur = sel[a];            sel.left = sel.left + right;            sel.top = sel.top - down;        }    }        function lockUnlockBg(lock){    	master.layers.getByName("Guides").locked = lock;    	master.layers.getByName("BKGRD, do not unlock").locked = lock;    }        function unlockSource(){    	docRef.layers.getByName("Guides").locked = false;		docRef.layers.getByName("BKGRD, do not unlock").locked = false;		docRef.layers[0].layers.getByName("Information").locked = false;        docRef.layers[0].layers.getByName("Prepress").visible = true;    }        function lockArtMaster(){	    var theLayer = master.layers[0];	    theLayer.layers.getByName("Information").locked = true;	    theLayer.layers.getByName("Prepress").visible = false;	    theLayer.zOrder(ZOrderMethod.SENDTOBACK);	    master.layers.getByName("Guides").zOrder(ZOrderMethod.SENDTOBACK);	    master.layers.getByName("BKGRD, do not unlock").zOrder(ZOrderMethod.SENDTOBACK);    }            /////////////////    ///Script Main///    /////////////////        /////////////////////////////    ///Script Global Variables///    /////////////////////////////        var docRef = app.activeDocument;    var layers = docRef.layers;    var masterFile = getTargetDoc();    if(masterFile == null){return;}    var master = app.documents.getByName(masterFile);    var valid = true;    var move = [];        ///////////////////////    ///Function Callouts///    ///////////////////////            createNewArtboard();    if(valid){    	unlockSource();        lockUnlockBg(false);    }    if(valid){        copyArt();        pasteArt();    }    lockArtMaster();    lockUnlockBg(true);            }mergeDocuments();