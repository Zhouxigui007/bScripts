#target illustratorfunction ArtboardSwatches(){    // Spot colors or ink plates only!        function existCheckLayer(){        for (L=0; L<layers.length; L++){            $.writeln(layers[L].name);            if(layers[L].name == "Check Layer"){                layers[L].remove();                break;                } // end if layer name is check layer            }// end for loop L        $.writeln("checkLayerExist = " + checkLayerExist);        } // end function existCheckLayer();        function turnOffPrinting(){        for (p=0; p<layers.length;p++){            layers[p].printable = false;            layers[p].locked = false;            }        } // end function turnOffPrinting();        function turnOnPrinting(){        for (p=0; p<layers.length; p++){            layers[p].printable = true;            if(layers[p].name == "Check Layer"){                layers[p].remove();                } // end if //remove check layer            } // end for loop        } // end function turnOnPrinting();        function checkArtboardInks(index){        // Function 1:  gets the list of names from spot inks on an artboards.  Names will be used later to write the swatches.        //  Will set the active index and a selection.        doc.selection = null;                if (checkLayerExist == false){            var checkLayer = layers.add();            checkLayer.name = "Check Layer";            checkLayer.printable = true;            }        doc.artboards.setActiveArtboardIndex(index);        doc.selectObjectsOnActiveArtboard();        for(duplicate=0; duplicate < doc.selection.length; duplicate ++){            var currentSelection = doc.selection[duplicate];            currentSelection.duplicate(checkLayer, ElementPlacement.PLACEATEND);            } // end for loop 'duplicate'        var inkList = doc.inkList;        var dontAddPlate = ["Process Magenta", "process yellow", "process black", "Process Cyan", "cut line", "cut", "edge", "edge1", "edge2"];        var arr = [];        checkLayer.printable = true;        for(var i=0; i<inkList.length; i++){            var thisInk = inkList[i];            $.writeln(thisInk.inkInfo.printingStatus);            if(thisInk.inkInfo.printingStatus == InkPrintStatus.ENABLEINK && thisInk.name != "Process Cyan"&& //            thisInk.name != "Process Magenta" && thisInk.name != "Process Yellow" && thisInk.name != "Process Black" && //            thisInk.name != "[Registration]" && thisInk.name != "[None]" && thisInk.name.toLowerCase() != "cut line" && //            thisInk.name.toLowerCase() != "edge") {                arr.push(thisInk.name);//~                 swatchList.push(thisInk.name);                $.writeln(arr + " ink list for artboard " + a);            } // end if printing status enabled        } // end for loop i        return (arr);    }    function writeSwatchesAtBottomOfArtboard(swatchList, artboardIndex){        //Function 2: writes the actual info, in this case rectangles.        var arb = doc.artboards[artboardIndex];        var arbRct = arb.artboardRect;        var x = arbRct[0] - 95;  // I pulled this out of my ear.        var y = arbRct[3] + 60;                        if(swatchList.length > 0){            var darkSwatches = ['Black B', 'Dark Green B', 'Maroon B', 'Cardinal B', 'Navy B', 'Royal Blue B', 'Brown B', 'Dark Charcoal B', 'Purple B', 'Kelly Green B']            var newGrp = doc.layers[0].groupItems.add();            newGrp.name = "Swatches for Artboard "+(artboardIndex+1);            for(var j=0; j<swatchList.length; j++){                var thisSwatchName = swatchList[j];                var colorBox = newGrp.pathItems.rectangle(y, x+=100, 100, 20);                var textBox = newGrp.pathItems.rectangle(y-6, x+5, 90,15);                  var textRefBox = newGrp.textFrames.areaText(textBox);                var lightColorText = swatches.getByName("Black B").color;                var darkColorText = swatches.getByName("White B").color;                var textRefColor = lightColorText;                textRefBox.contents = thisSwatchName;                for(d=0; d<darkSwatches.length; d++){ //check if thisSwatchName is in dark swatches array                    if (thisSwatchName == darkSwatches[d]){                        textRefColor = darkColorText;                        } // end if in_array                    } // end for loop D                textRefBox.textRange.fillColor = textRefColor;                colorBox.stroked = false;                colorBox.filled = true;//~                 $.writeln(thisSwatchName);                colorBox.fillColor = doc.swatches.getByName(thisSwatchName).color; //Fill the swatch square with the color.                if(thisSwatchName == "White B"){                    colorBox.stroked = true;                    colorBox.strokeColor = doc.swatches.getByName("Black B").color;                    }            }        }    }        function existLabelColors(){        for (c=0; c<swatches.length; c++){            $.writeln(swatches[c].name);            if (swatches[c].name == "White B"){                existWhite = true;                $.writeln("white b swatch true");                }            if (swatches[c].name == "Black B"){                existBlack = true;                $.writeln("black b swatch true");                }            }// end for loop C        if(existWhite == false){            var whiteLabel = doc.spots.add();            whiteLabelColor = new CMYKColor();            whiteLabelColor.cyan = 0;            whiteLabelColor.magenta = 0;            whiteLabelColor.yellow = 0;            whiteLabelColor.black = 0;            whiteLabel.name = "White B";            whiteLabel.color = whiteLabelColor;            whiteLabel.colorType = ColorModel.SPOT;            whiteLabel.tint = 100;            } // end create white label swatch                if(existBlack == false){            var blackLabel = doc.spots.add();            blackLabelColor = new CMYKColor();            blackLabelColor.cyan = 72;            blackLabelColor.magenta = 67;            blackLabelColor.yellow = 63;            blackLabelColor.black = 72;            blackLabel.name = "Black B";            blackLabel.color = blackLabelColor;            blackLabel.colorType = ColorModel.SPOT;            blackLabel.tint = 100;            } // end create black label swatch        } // end function existLabelColors();//============================================================= Main Script starts here    if(app.documents.length > 0){        var doc = app.activeDocument;        var swatches = doc.swatches;        var layers = doc.layers;        $.writeln(layers.length + " Layers");        var checkLayerExist = false;        var checkLayer = null;        existCheckLayer();        turnOffPrinting();        var existWhite = false;        var existBlack = false;        var swatchList = [];        existLabelColors();        for(var a=0; a<doc.artboards.length; a++){  // this goes through all artboards and writes the swatches.            var thisList = (checkArtboardInks(a));            writeSwatchesAtBottomOfArtboard(thisList, a);        }    turnOnPrinting();        doc.selection = null; // clear selection one final time.    } else {        alert("No document is open!");    }}ArtboardSwatches();